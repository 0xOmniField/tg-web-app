import CrystalIcon from "@assets/games/Icons/Crystal.png";
import InterstellarMineralIcon from "@assets/games/Icons/InterstellarMineral.png";
import BiomassIcon from "@assets/games/Icons/Biomass.png";
import QuantumFoamIcon from "@assets/games/Icons/QuantumFoam.png";
import NecrodermisIcon from "@assets/games/Icons/Necrodermis.png";
import AlienFloralIcon from "@assets/games/Icons/AlienFloral.png";
import SpiceMelangeIcon from "@assets/games/Icons/SpiceMelange.png";
import TitaniumIcon from "@assets/games/Icons/Titanium.png";
import EnercoreIcon from "@assets/games/Icons/Enercore.png";
import NexiumIcon from "@assets/games/Icons/Nexium.png";
import SwiftexIcon from "@assets/games/Icons/Swiftex.png";
import CognisurgeIcon from "@assets/games/Icons/Cognisurge.png";
import VitalshieldIcon from "@assets/games/Icons/Vitalshield.png";
import FlexonixIcon from "@assets/games/Icons/Flexonix.png";
import Bot1 from "@assets/games/CreatureBots/robot1.png";
import Bot2 from "@assets/games/CreatureBots/robot2.png";
import Bot3 from "@assets/games/CreatureBots/robot3.png";
import Bot4 from "@assets/games/CreatureBots/robot4.png";
import Bot1Background from "@assets/games/Animations/background/1.png";
import Bot2Background from "@assets/games/Animations/background/2.png";
import Bot3Background from "@assets/games/Animations/background/3.png";
import Bot4Background from "@assets/games/Animations/background/4.png";
import Bot1RoleAnimation from "@assets/games/Animations/role/1.json";
import Bot2RoleAnimation from "@assets/games/Animations/role/2.json";
import Bot3RoleAnimation from "@assets/games/Animations/role/3.json";
import Bot4RoleAnimation from "@assets/games/Animations/role/4.json";
import BioGen from "@assets/games/Animations/Programs/BioGen.png";
import CrysTara from "@assets/games/Animations/Programs/CrysTara.png";
import AstroMine from "@assets/games/Animations/Programs/AstroMine.png";
import CrystaBloom from "@assets/games/Animations/Programs/CrystaBloom.png";
import EnerGex from "@assets/games/Animations/Programs/EnerGex.png";
import StellarCharge from "@assets/games/Animations/Programs/StellarCharge.png";
import FoamTap from "@assets/games/Animations/Programs/FoamTap.png";
import EnerFusion from "@assets/games/Animations/Programs/EnerFusion.png";
import EnerPlex from "@assets/games/Animations/Programs/EnerPlex.png";
import TTgenesis from "@assets/games/Animations/Programs/TTgenesis.png";
import QuantaForge from "@assets/games/Animations/Programs/QuantaForge.png";
import FortiFyx from "@assets/games/Animations/Programs/FortiFyx.png";
import SynTitan from "@assets/games/Animations/Programs/SynTitan.png";
import SwiftForge from "@assets/games/Animations/Programs/SwiftForge.png";
import XenoFloral from "@assets/games/Animations/Programs/XenoFloral.png";
import TitaniumBoost from "@assets/games/Animations/Programs/TitaniumBoost.png";
import CerebraSpark from "@assets/games/Animations/Programs/CerebraSpark.png";
import QuiFoam from "@assets/games/Animations/Programs/QuiFoam.png";
import AstroCharge from "@assets/games/Animations/Programs/AstroCharge.png";
import EnerGate from "@assets/games/Animations/Programs/EnerGate.png";
import CogniMelt from "@assets/games/Animations/Programs/CogniMelt.png";
import NexiMine from "@assets/games/Animations/Programs/NexiMine.png";
import XenoBloom from "@assets/games/Animations/Programs/XenoBloom.png";
import ResoNex from "@assets/games/Animations/Programs/ResoNex.png";
import Fortivest from "@assets/games/Animations/Programs/Fortivest.png";
import CogniFy from "@assets/games/Animations/Programs/CogniFy.png";
import FortiGen from "@assets/games/Animations/Programs/FortiGen.png";
import Abracadabra from "@assets/games/Animations/Programs/Abracadabra.png";
import MegaBoost from "@assets/games/Animations/Programs/MegaBoost.png";
import NexuMax from "@assets/games/Animations/Programs/NexuMax.png";
import SpicenRich from "@assets/games/Animations/Programs/SpicenRich.png";
import EvolviFy from "@assets/games/Animations/Programs/EvolviFy.png";
import NexroVest from "@assets/games/Animations/Programs/NexroVest.png";
import QuantumScribe from "@assets/games/Animations/Programs/QuantumScribe.png";
import NeuroForge from "@assets/games/Animations/Programs/NeuroForge.png";
import CyberPulse from "@assets/games/Animations/Programs/CyberPulse.png";
import PlasmaShift from "@assets/games/Animations/Programs/PlasmaShift.png";
import IlluGen from "@assets/games/Animations/Programs/IlluGen.png";
import Aespa from "@assets/games/Animations/Programs/Aespa.png";
import SuperNova from "@assets/games/Animations/Programs/SuperNova.png";
import NeuroCharge from "@assets/games/Animations/Programs/NeuroCharge.png";
import QuantumLeap from "@assets/games/Animations/Programs/QuantumLeap.png";
import BioSynthesis from "@assets/games/Animations/Programs/BioSynthesis.png";
import PlasmaForge from "@assets/games/Animations/Programs/PlasmaForge.png";
import NanoWeave from "@assets/games/Animations/Programs/NanoWeave.png";
import EtherPulse from "@assets/games/Animations/Programs/EtherPulse.png";
import StarLight from "@assets/games/Animations/Programs/StarLight.png";
import NovaBurst from "@assets/games/Animations/Programs/NovaBurst.png";
import BioHarvest from "@assets/games/Animations/Programs/BioHarvest.png";
import EtherForge from "@assets/games/Animations/Programs/EtherForge.png";
import TitanBloom from "@assets/games/Animations/Programs/TitanBloom.png";
import QuantumFrost from "@assets/games/Animations/Programs/QuantumFrost.png";
import BioFusion from "@assets/games/Animations/Programs/BioFusion.png";
import NexusField from "@assets/games/Animations/Programs/NexusField.png";
import StarForge from "@assets/games/Animations/Programs/StarForge.png";
import PlasmaCharge from "@assets/games/Animations/Programs/PlasmaCharge.png";
import BioCast from "@assets/games/Animations/Programs/BioCast.png";
import EtherWeave from "@assets/games/Animations/Programs/EtherWeave.png";
import NovaFlux from "@assets/games/Animations/Programs/NovaFlux.png";
import QuantumCore from "@assets/games/Animations/Programs/QuantumCore.png";
import BioSurge from "@assets/games/Animations/Programs/BioSurge.png";
import StarlightForge from "@assets/games/Animations/Programs/StarlightForge.png";
import QuantumSurge from "@assets/games/Animations/Programs/QuantumSurge.png";
const mapBg = {
  BioGen,
  CrysTara,
  AstroMine,
  CrystaBloom,
  EnerGex,
  StellarCharge,
  FoamTap,
  EnerFusion,
  EnerPlex,
  TTgenesis,
  QuantaForge,
  FortiFyx,
  SynTitan,
  SwiftForge,
  XenoFloral,
  TitaniumBoost,
  CerebraSpark,
  QuiFoam,
  AstroCharge,
  EnerGate,
  CogniMelt,
  NexiMine,
  XenoBloom,
  ResoNex,
  Fortivest,
  CogniFy,
  FortiGen,
  Abracadabra,
  MegaBoost,
  NexuMax,
  SpicenRich,
  EvolviFy,
  NexroVest,
  QuantumScribe,
  NeuroForge,
  CyberPulse,
  PlasmaShift,
  IlluGen,
  Aespa,
  SuperNova,
  NeuroCharge,
  QuantumLeap,
  BioSynthesis,
  PlasmaForge,
  NanoWeave,
  EtherPulse,
  StarLight,
  NovaBurst,
  BioHarvest,
  EtherForge,
  TitanBloom,
  QuantumFrost,
  BioFusion,
  NexusField,
  StarForge,
  PlasmaCharge,
  BioCast,
  EtherWeave,
  NovaFlux,
  QuantumCore,
  BioSurge,
  StarlightForge,
  QuantumSurge,
};

import { useEffect, useState } from "react";

export interface CreatureModel {
  rareResources: ResourceAmountPair[];
  name: string;
  isLocked: boolean;
  creatureType: number;
  programIndexes: Array<number | null>;
  currentProgramIndex: number;
  isProgramStop: boolean;
  startTime: number;
}

export enum ProgramType {
  BioGen,
  CrysTara,
  AstroMine,
  CrystaBloom,
  EnerGex,
  StellarCharge,
  FoamTap,
  EnerFusion,
  EnerPlex,
  TTgenesis,
  QuantaForge,
  FortiFyx,
  SynTitan,
  SwiftForge,
  XenoFloral,
  TitaniumBoost,
  CerebraSpark,
  QuiFoam,
  AstroCharge,
  EnerGate,
  CogniMelt,
  NexiMine,
  XenoBloom,
  ResoNex,
  Fortivest,
  CogniFy,
  FortiGen,
  Abracadabra,
  MegaBoost,
  NexuMax,
  SpicenRich,
  EvolviFy,
  NexroVest,
  QuantumScribe,
  NeuroForge,
  CyberPulse,
  PlasmaShift,
  IlluGen,
  Aespa,
  SuperNova,
  NeuroCharge,
  QuantumLeap,
  BioSynthesis,
  PlasmaForge,
  NanoWeave,
  EtherPulse,
  StarLight,
  NovaBurst,
  BioHarvest,
  EtherForge,
  TitanBloom,
  QuantumFrost,
  BioFusion,
  NexusField,
  StarForge,
  PlasmaCharge,
  BioCast,
  EtherWeave,
  NovaFlux,
  QuantumCore,
  BioSurge,
  EtherPulse2,
  StarlightForge,
  QuantumSurge,
}

export interface ProgramModel {
  index: number;
  type: ProgramType;
  processingTime: number;
  resources: Array<ResourceAmountPair>;
  name: string;
}

export interface ProgramInfo {
  program: ProgramModel | null;
  index: number | null;
  remainTime: number;
  progress: number;
}

export enum ResourceType {
  Crystal,
  InterstellarMineral,
  Biomass,
  QuantumFoam,
  Necrodermis,
  AlienFloral,
  SpiceMelange,
  Titanium,
  Enercore,
  Nexium,
  Swiftex,
  Cognisurge,
  Vitalshield,
  Flexonix,
}

export interface ResourceAmountPair {
  type: ResourceType;
  amount: number;
}

export interface FilterModel {
  dict: { [key in ResourceType]?: boolean };
}

export enum GuideType {
  None,
  First,
}

export const commonResourceTypes = [
  ResourceType.Crystal,
  ResourceType.InterstellarMineral,
  ResourceType.Biomass,
  ResourceType.QuantumFoam,
  ResourceType.Necrodermis,
  ResourceType.AlienFloral,
  ResourceType.SpiceMelange,
  ResourceType.Titanium,
];

export const rareResourceTypes = [
  ResourceType.Enercore,
  ResourceType.Nexium,
  ResourceType.Swiftex,
  ResourceType.Cognisurge,
  ResourceType.Vitalshield,
  ResourceType.Flexonix,
];

export const allResourceTypes = [...commonResourceTypes, ...rareResourceTypes];

export const emptyCommonResources = commonResourceTypes.map((type) => ({
  type,
  amount: 0,
}));

export const emptyRareResources = rareResourceTypes.map((type) => ({
  type,
  amount: 0,
}));

export const emptyCreature: CreatureModel = {
  rareResources: emptyRareResources,
  name: "",
  isLocked: false,
  creatureType: -1,
  programIndexes: [null, null, null, null, null, null, null, null],
  currentProgramIndex: 0,
  isProgramStop: false,
  startTime: 0,
};

export function getCreatingCreature(creatureType: number): CreatureModel {
  return {
    rareResources: emptyRareResources,
    name: "Creating",
    isLocked: false,
    creatureType: creatureType,
    programIndexes: [null, null, null, null, null, null, null, null],
    currentProgramIndex: 0,
    isProgramStop: false,
    startTime: 0,
  };
}

export const allResourcesToggleFilter: FilterModel = {
  dict: allResourceTypes.reduce((acc, type) => {
    acc[type] = false;
    return acc;
  }, {} as { [key in ResourceType]?: boolean }),
};

export function getCommonResources(array: Array<number>) {
  return commonResourceTypes.map((type, index) => ({
    type,
    amount: array[index],
  }));
}

export function getRareResources(array: Array<number>) {
  return rareResourceTypes.map((type, index) => ({
    type,
    amount: array[index],
  }));
}

export function getResourceIconPath(type: ResourceType): string {
  switch (type) {
    case ResourceType.Crystal:
      return CrystalIcon;
    case ResourceType.InterstellarMineral:
      return InterstellarMineralIcon;
    case ResourceType.Biomass:
      return BiomassIcon;
    case ResourceType.QuantumFoam:
      return QuantumFoamIcon;
    case ResourceType.Necrodermis:
      return NecrodermisIcon;
    case ResourceType.AlienFloral:
      return AlienFloralIcon;
    case ResourceType.SpiceMelange:
      return SpiceMelangeIcon;
    case ResourceType.Titanium:
      return TitaniumIcon;
    case ResourceType.Enercore:
      return EnercoreIcon;
    case ResourceType.Nexium:
      return NexiumIcon;
    case ResourceType.Swiftex:
      return SwiftexIcon;
    case ResourceType.Cognisurge:
      return CognisurgeIcon;
    case ResourceType.Vitalshield:
      return VitalshieldIcon;
    case ResourceType.Flexonix:
      return FlexonixIcon;
    default:
      throw new Error("Unknown ResourceType");
  }
}

export function getResourceNameText(type: ResourceType): string {
  switch (type) {
    case ResourceType.Crystal:
      return "Crystal";
    case ResourceType.InterstellarMineral:
      return "Interstellar Mineral";
    case ResourceType.Biomass:
      return "Biomass";
    case ResourceType.QuantumFoam:
      return "Quantum Foam";
    case ResourceType.Necrodermis:
      return "Necrodermis";
    case ResourceType.AlienFloral:
      return "Alien Floral";
    case ResourceType.SpiceMelange:
      return "Spice Melange";
    case ResourceType.Titanium:
      return "Titanium";
    case ResourceType.Enercore:
      return "Enercore";
    case ResourceType.Nexium:
      return "Nexium";
    case ResourceType.Swiftex:
      return "Swiftex";
    case ResourceType.Cognisurge:
      return "Cognisurge";
    case ResourceType.Vitalshield:
      return "Vitalshield";
    case ResourceType.Flexonix:
      return "Flexonix";
    default:
      throw new Error("Unknown ResourceType");
  }
}

export function getNumberAbbr(num: number): string {
  const abbr = [
    { value: 1e12, suffix: "T" },
    { value: 1e9, suffix: "B" },
    { value: 1e6, suffix: "M" },
    { value: 1e3, suffix: "K" },
  ];
  const sign = num < 0 ? "-" : "";

  num = Math.abs(num);
  for (let i = 0; i < abbr.length; i++) {
    if (num >= abbr[i].value) {
      let formattedNumber = (num / abbr[i].value).toFixed(1);
      if (formattedNumber.endsWith(".0")) {
        formattedNumber = formattedNumber.slice(0, -2);
      }
      return sign + formattedNumber + abbr[i].suffix;
    }
  }

  return sign + num.toString();
}

const botIconPaths = [
  {
    bot: Bot1,
    background: Bot1Background,
    role: Bot1RoleAnimation,
  },
  {
    bot: Bot2,
    background: Bot2Background,
    role: Bot2RoleAnimation,
  },
  {
    bot: Bot3,
    background: Bot3Background,
    role: Bot3RoleAnimation,
  },
  {
    bot: Bot4,
    background: Bot4Background,
    role: Bot4RoleAnimation,
  },
];

export const getCreatureIconPath = (
  creatureType: number
): {
  bot: string;
  background: any;
  role: any;
} => {
  return creatureType == -1
    ? {
        bot: "",
        background: Bot1Background,
        role: "",
      }
    : botIconPaths[creatureType % botIconPaths.length];
};

export const ProgramComponent = ({
  program,
  showAnimation,
}: {
  program: ProgramModel | null;
  showAnimation: boolean;
}): JSX.Element | null => {
  return program == null ? null : (
    <div
      className="main-bot-program-image"
      style={
        showAnimation
          ? { animation: `${program.name} 2s steps(24) infinite` }
          : {
              backgroundImage: `url(${
                mapBg?.[program.name as keyof typeof mapBg] || ""
              })`,
            }
      }
    />
  );
};
